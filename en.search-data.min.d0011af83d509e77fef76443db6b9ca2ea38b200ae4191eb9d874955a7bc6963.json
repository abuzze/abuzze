[{"id":0,"href":"/posts/homelab/","title":"Homelab","section":"Posts","content":"Using a NUC i7 as an ESXi Server #  Why buying a NUC instead of a real server #  I am using a NUC i7 10710U with 32GB RAM and a 1 TB SSD for my lab, mainly because of the small form factor and the low power consumption. Setting up a 19'' Server is not an option for me and the NUCs are a good learning platform, if you only need a few small VMs.\n"},{"id":1,"href":"/docs/active-directory/","title":"AD Cheatsheet","section":"Cheatsheets","content":"Windows/Mac Active Directory Cheatsheet #  Show Kerberos Tickets and create sessions for a user account\nklist kinit user@domain.tld klist kdestroy Show AD Settings on a macbook\ndsconfigad -show Troubleshoot Directory Service issues on a Macbook\ndscl ls dsAttrTypeNative:userAccountControl: 512 change usabilitytest dsAttrTypeNative:userAccountControl 66080 512 Find all account computer accounts in the active directory\n(Get-ADComputer -Filter * -Properties PasswordLastSet,LastLogonDate,OperatingSystem | ? { $_.LastLogonDate -GT $(Get-Date).AddDays(-180) } | Select Name,PasswordLastSet,LastLogonDate,Operatingsystem | ? {$_.OperatingSystem -like \u0026quot;MAC*\u0026quot;} | Sort-Object PasswordLastSet -Descending).count "},{"id":2,"href":"/docs/cheat-sheet/","title":"Arduino Cheatsheet","section":"Cheatsheets","content":"Arduino #  Arduino Nano #  Settings for Arduino IDE #  Tools \u0026gt; Board \u0026gt; Arduino Nano Tools \u0026gt; Processor \u0026gt; ATMEGA328P Old Bootloader Tools \u0026gt; Programmer \u0026gt; ArdinoISP Tools \u0026gt; Port \u0026gt; Select COMX (replug to check which port is new. It\u0026rsquo;s never COM1)\nSimple Programs #  Onboard LED Blink #  int LED = 13; //13 for L LED or 30 for RX LED int DelayTime = 500; void setup() { pinMode(13, OUTPUT); } void loop() { digitalWrite(LED, HIGH); delay(DelayTime); digitalWrite(LED,LOW); delay(DelayTime); } Buttontester #  // Blink the onboard LED, when a button is pressed  const int LED = 13; // sets LED to pin 13 const int DelayTime = 500; const int buttonPin = 2; // the number of the pushbutton pin  int buttonState = 0; void setup() { pinMode(LED, OUTPUT); pinMode(buttonPin, INPUT_PULLUP); //define INPUT_PULLUP to use the onboard resistor } void loop() { buttonState = digitalRead(buttonPin); if (buttonState == HIGH) { digitalWrite(LED,LOW); // LED ON  } else{ digitalWrite(LED,HIGH); // LED OFF  } } Simple Keyboard (Won\u0026rsquo;t work with Nano. Needs an ATmega16U2) #  int buttonPin = 9; // Set a button to any pin  void setup() { pinMode(buttonPin, INPUT); // Set the button as an input  digitalWrite(buttonPin, HIGH); // Pull the button high } void loop() { if (digitalRead(buttonPin) == 0) // if the button goes low  { Keyboard.write(\u0026#39;z\u0026#39;); // send a \u0026#39;z\u0026#39; to the computer via Keyboard HID  delay(1000); // delay so there aren\u0026#39;t a kajillion z\u0026#39;s  } } "},{"id":3,"href":"/docs/","title":"Cheatsheets","section":"Memoirs of a sysadmin","content":"Cheatsheets #  This is a collection of my personal notes, that i took over the past 10 years.\n"},{"id":4,"href":"/docs/cisco/","title":"Cisco Cheatsheet","section":"Cheatsheets","content":"Cisco Cheatsheet #  Enable SSH login on a Catalyst 3850 #  configure terminal hostname name ip domain-name name crypto key generate rsa ip ssh [time-out seconds | authentication-r etries integer ] ip ssh version 2 line vty 5 15 exec-timeout 15 0 transport input ssh access-class authorized-managers in ! ip access-list extended authorized-managers permit ip 172.25.0.0 0.0.255.255 any permit ip host 172.20.3.195 any permit ip host 172.20.1.133 any Check this when setting up new switches. #  cisco password change\nenable secret new_password enable logging to syslogserver:\nlogging ip_syslogserver disable vtp mode\nvtp off If you use Portchanels, verify at least on side is active not \u0026ldquo;on\u0026rdquo;\nchannelgroup 1 mode active conf t interface fa 0/1 switchport access vlan 1 Editing ACLs #  Note the line numbering in the required access-list e.g.: 1 2 3 4\nextended IP access-list 115 10 access-list 115 deny ip host 222.222.222.222 any 20 access-list 115 permit ip any any Then enter config mode and insert the line you want to add, prefixing it with the appropriate number to position it where you want in the list (substitute standard for extended in the example below if you are working with a standard ACL):\n1 2 3 4 5\nconf t ip access-list extended 115 15 deny ip host 111.111.111.111 any end SDM #  sdm prefer sh plattform tcam util Spanning Tree #  STP #  Changing Root Prio is possible via two ways\n spanning-tree vlan vlan-id priority bridge-priority Changing root bridge via macro. Sets prio to 24576 if current root prio is above that value, or to 4096 if below.\n spanning-tree vlan vlan-id root primary Loopguard #  LG prevents Loop, with unidirectional links (broken SFPs)\nRootguard cannot be enable on the same port as Loopguard. Loopguard would disable Rootguard on the port.\nUniDirectionalLinkDetection - UDLD #  Detects if only one fibre strand is connected\nudld aggressive mode try to reenable the link, while normal mode just err-disables the port.\nGlobal config all ports\n udld enable | aggressive Config per port\n udld port Verify config\n show udld Reset err-disabled ports\n udld reset VTP #  Pruefungsfrage 1-1001 (VTP1,2,3) 1002-1005 FDDI/Token Ring extended VLAN 1006-4094 (VTP3)\nUnterschiede VTP Versionen\n VTP3 lernt nicht automatisch den Domainnamen VTP Pruning sorgt dafuer das Switches, deren Mgmt VLAN verschieden ist keine VTP Daten uebertragen.  Link Aggregation #  Static und Dynamic sind miteinander nicht kompatibel\nStatic - On, ohne Protokoll\nDynamic\n*PAgP (Cisco) *LACP\nEtherchannel \u0026gt; Prozess Portchannel \u0026gt; Interface\nBedingung:\n gleicher Speed auf beiden Seiten \u0026ldquo;access \u0026lt;\u0026gt; access\u0026rdquo; oder \u0026ldquo;Trunk \u0026lt;\u0026gt; Trunk\u0026rdquo; gleiche VLANs   sh etherchannel sum NTP #  Configure the ntp on a switch. This also enables the ntp server mode on the switch. Use access lists to prevent other clients from accessing the ntp services on the switch.\n ntp server ip Securing NTP with access list\n access-list 1 permit 10.1.0.0 0.0.255.255 ntp access-group serve-only 1 Configures the switch to only answer ntp sync requests from 10.1.0.0/16\nPrüfung: NTP Versionen und Unterschiede!\nSNMPv3 #  To prevent index shuffle during reboot and software updates set\n snmp-server ifindex persist Enable and limit the traps to cpu and port-security\n access-list 99 permit 10.1.1.0 0.0.0.255 snmp-server view OPS snmp-server group groupZ v3 priv read OPS access 99 snmp-server group userZ groupZ v3 auth sha secret priv aes 256 anothersecret snmp-server enable traps snmp-server host ip traps version 3 priv userZ cpu port-security IP SLA #  measure udp-jitter, etc from a switch to another switch. Should be visible in librenms Storm control #   storm-control broadcast level 1.0 0.70 Port-Security #  enable on all access ports to prevent MAC address flooding\nDHCP Spoofing #  configure ip dhcp snooping first and then ip source guard, to prevent devices from using fixed ip addresses.\n ip dhcp snooping int Te1/0/1 desc uplink ip dhcp snooping trust ip dhcp snooping int gi1/0/1 ip verify source show all IP addresses on the switch ports\n sh ip verify source Dynamic ARP Inspection #  prevents arp poisoning\n int Te1//0/1 desc uplink ip arp inspection trust ip arp inspection vlan 5 "},{"id":5,"href":"/docs/docker/","title":"Docker Cheatcheet","section":"Cheatsheets","content":"Docker Cheatsheat #  Cleanup #  Diskspace and resources used\n docker system df\rThe RECLAIMABLE column shows how much diskspace can be saved by deleting unused images\nThe size of an image\n docker image ls\rThe content of a volume. This will show the mountpoint, which can be inspected with du.\n docker volume ls\rdocker volume inspect 69915af8ddf99\rRemove all containers and their volumes (works only if all containers are stopped)\n docker ps -a -q | xargs docker rm -v\rList/remove all stopped containers\n docker container ls --filter \u0026quot;status=exited\u0026quot; -aq\rdocker container rm $(docker container ls --filter \u0026quot;status=exited\u0026quot; -aq)\rRemove all dangling images\n docker images -f dangling=true -q | xargs docker rmi\rRemove docker volumes\n docker volume rm $(docker volume ls -q)\rRemove networks\n docker network rm \u0026lt;NETWORK_ID\u0026gt;\rPrune all unused resources, exept volumes\nWARNING! This will remove:\r- all stopped containers\r- all networks not used by at least one container\r- all dangling images\r- all dangling build cache\r docker system prune\rRunning a cleanup job is possible, via a container: https://github.com/meltwater/docker-cleanup\n"},{"id":6,"href":"/docs/git/","title":"Git Cheatsheet","section":"Cheatsheets","content":"GITHUB CHEATSHEET #  Creating a new local repo\ngit init git add . git commit -m \u0026quot;Initial commit\u0026quot; Show commit history\ngit log Reverting everything to the last committed state\ngit reset git checkout . Hard delete unpublished commits\n# This will destroy any local modifications. # Don't do it if you have uncommitted work you want to keep. git reset --hard 0d1d7fc32 # or switch to the last commit git reset --hard HEAD Checking unstaged changes\ngit status Pulling from master to local repository\ngit init (only first time) git remote add upstream \u0026lt;master repository url\u0026gt; # (only first time) git pull upstream master \u0026lt;master repository url\u0026gt; Pushing from local repository to personal fork. This is however only necessary when you plan on doing a pull request to the master\ngit push origin master Committing changes to the local repository:\ngit commit -m \u0026lt;commit message\u0026gt; Committing changes to the local repository, without adding new files (only modified files:\ngit commit -a -m \u0026lt;commit message\u0026gt; Creating a new repository #   Go to your own github page @ https://github.com/ Click New repository Define a  Provide a description Choose public (or private if you wish to pay the required fee of $7.00/month) Choose wheter or not you wish to create the new repository with a README file Click Create repository Open your prefered terminal and execute the following  git config --global user.name \u0026quot;Your name\u0026quot; git config --global user.email your@email.domain git config --global core.editor \u0026quot;subl -w\u0026quot; mkdir \u0026lt;repository name\u0026gt; cd \u0026lt;repository name\u0026gt; git init Renaming a file via git, so it doesn\u0026rsquo;t count as a new file #  git mv oldfilename newfilename Deleting a file via git #  git rm filename untracking a file that was already commited and tracked, but is now in the .gitignore #  git update-index --assume-unchanged \u0026lt;file\u0026gt; retracking that file, please remove from .gitignore before you do this #  git update-index --no-assume-unchanged \u0026lt;file\u0026gt; "},{"id":7,"href":"/docs/juniper/","title":"Juniper Cheatsheet","section":"Cheatsheets","content":"Juniper Cheatsheet #  Configuration #  Run a command in configure mode\nrun ping 172.20.1.1 run show interface terse copy configuration via terminal #  Delete the old config first\ndelete vlans delete interfaces delete system etc. Copy the complete config via ctrl+c\nload merge terminal relative show | compare commit and-quit Display Infos #  Show all interfaces status\nshow interface terse show interface description Show all configured options as set commands\nshow configuration | display set show configuration | display set | match irb Show all vlans\nshow configuration vlans VLAN1 { vlan-id 1; l3-interface irb.1; } VLAN5 { vlan-id 5; l3-interface irb.5; } show vlans Routing instance VLAN name Tag Interfaces default-switch VLAN1 1 ae128.0 ge-0/0/0.0* ge-0/0/1.0 ge-0/0/6.0 default-switch VLAN5 5 ae128.0 ge-0/0/0.0* ge-0/0/7.0 List older configs\nrollback ? rollback to the last committed config and remove the candidate config\nrollback rollback to an older config\nrollback 20 compare the current config to a former config\nshow | compare rollback 2 compare your current changes to the saved config\nshow | compare "},{"id":8,"href":"/docs/k8s/","title":"K8S Cheatsheet","section":"Cheatsheets","content":"K8S cheatsheet #  Useful tools #  Colorize the output of kubectl. Use kubecolor instead.\nbrew install dty1er/tap/kubecolor  htop for k8s. Just run k9s\nbrew install derailed/k9s/k9s  Faster context switching between clusters with kubectx\nbrew install kubectx  Install #  Install on bare metal (Ubuntu) #  Used guide. Also a good source is this\n$ sudo apt update $ sudo apt install docker.io apt-transport-https curl -y $ sudo systemctl start docker $ sudo systemctl enable docker $ curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add $ sudo apt-add-repository \u0026quot;deb http://apt.kubernetes.io/ kubernetes-xenial main\u0026quot; $ sudo apt install kubeadm kubelet kubectl kubernetes-cni -y $ sudo swapoff -a  Disable the swapfile permanently\n$ sudo vim /etc/fstab  Rename the VMs\n$ sudo hostnamectl set-hostname kubernetes-master $ sudo hostnamectl set-hostname kubernetes-worker kubernetes-master:~$ sudo kubeadm init --pod-network-cidr=10.244.0.0/16 kubernetes-master:~$ mkdir -p $HOME/.kube kubernetes-master:~$ sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config kubernetes-master:~$ sudo chown $(id -u):$(id -g) $HOME/.kube/config kubernetes-master:~$ kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml kubernetes-master:~$ kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/k8s-manifests/kube-flannel-rbac.yml kubernetes-master:~$ kubectl get pods --all-namespaces kubernetes-worker:~$ sudo kubeadm join 192.168.1.220:6443 --token 1exb8s.2t4k3b5syfc3jfmo --discovery-token-ca-cert-hash sha256:72ad481cee4918cf2314738419356c9a402fb609263adad48c13797d0cba2341 kubernetes-master:~$ kubectl get nodes  To join a node at a later print, you can print the join code in the master. Don\u0026rsquo;t forget to add sudo to the kubeadm command or you will end up here.\nkubeadm token create --print-join-command  Check Component status\n$ kubectl get cs NAME STATUS MESSAGE ERROR scheduler Healthy ok controller-manager Healthy ok etcd-0 Healthy {\u0026quot;health\u0026quot;:\u0026quot;true\u0026quot;}  If the controller manager is unhealty \u0026gt; comment the line - \u0026ndash;port=0 in /etc/kubernetes/manifests/kube-controller-manager.yaml and restart k8s.\nsystemctl restart kubelet  MetalLB #  To access pods, you need a load balancer in front. MetalLB can be created like a service and will automatically assign one of the defined ip to this service. Example:\nkubectl expose pod kubia --type=LoadBalancer --name kubia-http --target-port=8080 --port=80  Target-port is the app, the app listens. Port is the outside port of the metalLB.\nCheck the \u0026ldquo;external ip\u0026rdquo; via\nkubectl get svc kubectl describe kubia-http  The pod, rc or deployment must have a label. You can add one with this command:\nkubectl label pod kubia-manual run=kubia-manual  Read the MetalLB Guide first.\nkubectl apply -f https://raw.githubusercontent.com/metallb/metallb/v0.10.2/manifests/namespace.yaml kubectl apply -f https://raw.githubusercontent.com/metallb/metallb/v0.10.2/manifests/metallb.yaml  Change the iprange for the LB in the config.yml\napiVersion: v1 kind: ConfigMap metadata: namespace: metallb-system name: config data: config: |address-pools: - name: default protocol: layer2 addresses: - 192.168.178.50-192.168.178.100 Apply the config\nkubectl apply -f config.yml  Port-Forward #  For debugging a port forward can be done, even on the client. This would forward traffic from the client, where the command is run on port 8888 to the pod in port 8080.\nkubectl port-forward kubia-manual 8888:8080  Labels #  Get all labels:\nkubectl get po --show-labels  Get specific labels\nkubectl get po -L env  Get all pod with a specific label value\nkubectl get pod -l run=kubia  Get all pod without a specific label\nkubectl get pod -l '!run'  Get all pod without a specific label and value\nkubectl get pod -l 'run!=kubia'  Get all pod with a selector\nkubectl get pod -l 'run in (test,dev,kubia)'  Get all pod without a selector\nkubectl get pod -l 'run notin (test,dev,kubia)'  Add a label to a pod\nkubectl label po kubia-manual creation_method=manual  To use labels and nodeSelectors to schedule pods on a specific not use this the the pods config.\nkubectl label node node3 speed=slow  apiVersion: v1 kind: Pod metadata: name: kubia-gpu spec: nodeSelector: speed: \u0026#34;slow\u0026#34; containers: - image: luksa/kubia name: kubia Namespaces #  To create a new namespace:\nkubectl create namespace custom-namespace  New namespace via yaml:\napiVersion: v1 kind: Namespace metadata: name: custom-namespace Deleting almost all resources in a namespace (pods,rc, service, etc). Does not delete secrets.\nkubectl delete all --all  Probes #  Liveness Probe #  A liveness probe checks via http, tcp or exec check if the container is still working and restarts it, if the probe fails.\nspec: containers: - image: luksa/kubia-unhealthy name: kubia livenessProbe: httpGet: path: / port: 8080 initialDelaySeconds: 15 ## set initial delay to prevent an unwanted restart when the container is created Check if the pod was restarted, because the probe failed. Exit Code 137 and 143 means killed externally.\nkubectl describe pod \u0026lt;podname\u0026gt;  State: Running Started: Sun, 04 Jul 2021 10:52:43 +0200 Last State: Terminated Reason: Error Exit Code: 137 Started: Sun, 04 Jul 2021 10:50:53 +0200 Finished: Sun, 04 Jul 2021 10:52:41 +0200 ReplicaController, ReplicaSets, DaemonSets, Deployments #  The ReplicaController is deprecated and can run any number of pods that match a label. The ReplicaSets is the successor and can run any number of pods, with different labels. The pods are run randomly and will be moved to the next node after 5 minutes if a nodes is down. The DaemonSets ensures that one pod is run on each node.\nJobs, CronJob #  Jobs #  Run once tasks. RestartPolicy must be set or the default will restart the job.\napiVersion: batch/v1 kind: Job metadata: name: batch-job spec: template: metadata: labels: app: batch-job spec: # Default is Always, which would restart the job. Switch to Never or OnFailure restartPolicy: OnFailure containers: - name: main image: luksa/batch-job CronJobs #  Running a pod at a scheduled time. Cronjobs can overlap.\napiVersion: batch/v1beta1 kind: CronJob metadata: name: batch-job-every-fifteen-minutes spec: schedule: \u0026#34;0,15,30,45 * * * *\u0026#34; jobTemplate: spec: template: metadata: labels: app: periodic-batch-job spec: restartPolicy: OnFailure containers: - name: main image: luksa/batch-job Ingress #  NGINX Ingress #  Baremetal Instructions\nInstall the Ingress Controller first and then point the LB to the ingress.\nInvestigate if this is working https://vincentlauzon.com/2020/02/11/ingress-rules-in-different-kubernetes-namespaces\n"},{"id":9,"href":"/docs/linux/","title":"Linux Cheatsheet","section":"Cheatsheets","content":"Basic Linux Cheatsheet #  Commands are in random order; execute at your own risk #  setup ansible in venv #  \teasy_install pip pip install virtualenv virtualenvwrapper mkdir ~/venv/ansible_2_5_11 virtualenv ~/venv/ansible_2_5_11 source ~/venv/ansible_2_5_11/bin/activate pip install nose cryptography tornado pip install ansible==2.5.11 to deactivate the venv\ndeactivate  Sendmail testen #  echo \u0026ldquo;Subject: test\u0026rdquo; | /usr/lib/sendmail -v me@domain.com\nfehlender Einf. key im Midnight Commander auf OSX\nCtrl + t markiert in mc einen einzelnen Eintrag  Prozesse die mit D markiert sind finden, um Performanceprobleme zu finden\nwhile true; do date; ps auxf | awk '{if($8==\u0026quot;D\u0026quot;) print $0;}'; sleep 1; done  welchen dateien werden von welchen Prozess genutzt\nlsof -p 16528  Wird ein unlinked file von einem Prozess offen gehalten?\nlsof -a +L1 /dev/file  oder per User\nlsof -u www-data  in Dateien suchen #  grep -r -i somethingtosearchfor ./ grep -rn $'\\xFEFE' * #utf8 BOM finden auch mit FEFF suchen  Dateien suchen #  find /var/ -name '*.jpg'  bestimmte dateien/ordner abcd in einem Unterverzeichis löschen #  find . -name abcd -type d -exec rm -rf {} \\;  um zu schauen welche Files betroffen sind\nfind . -name abcd -type d -exec echo {} \\;  Prozess in den Hintergrund schicken und mit disown gegen SIGHUP schützen, damit er weiterläuft und man die SSH Verbindung trotzdem beenden kann #  ./long_running_script ctrl+z #pausiert den Prozess bg #schickt ihn in den Hintergrund disown #schütz ihn gegen den SIGHUP beim beenden der SSH Session  Paketverwaltung #  Pakete suchen mit apt-get\napt-cache search Suchbegriff1 [Suchbegriff2]  Infos zum Paket anzeigen\napt-cache show Paketname  Infos zu möglichen Updates anzeigen\napt-cache policy \u0026lt;package name\u0026gt;  Version eines Pakets anzeigen\ndpkg -s \u0026lt;packagename\u0026gt;  Dateien die zu einem Paket gehören anzeigen\ndpkg -s \u0026lt;packagename\u0026gt;  PPA hinzufügen und Paket daraus installieren\nsudo add-apt-repository ppa:tuxpoldo/btsync sudo apt-get update sudo apt-get install btsync  PPA wieder entfernen\nsudo add-apt-repository --remove ppa:PPA_Name/ppa  falls add-apt-repository fehlt muss python-software-properties installiert werden\nsudo apt-get install python-software-properties  Alle Paket updaten und den Vorgang loggen (vorher apt-get update)\nsudo apt-get upgrade 2\u0026gt;\u0026amp;1 | tee ~/apt-get.log  Alte Kernel entfernen um Platz in /boot zu schaffen\nInstallierte Kernel anzeigen\ndpkg -l | grep linux-image  benutzten Kernel anzeigen\nuname -r  Kernel entfernen\ndpkg --remove linux-image-extra-4.2.0-15-generic  nur security updates installieren #  sudo cp /etc/apt/sources.list /etc/apt/security.sources.list\nEdit the latter to contain only security repositories, then:\nsudo apt-get upgrade -o Dir::Etc::SourceList=/etc/apt/security.sources.list\nprograme per source installieren #  source nach /tmp downloaden auspacken meist mit xfv source.tar.gz ./configure make checkinstall -D make install ##checkinstall muss ggfs. per apt-get installiert werden und erzeugt ein Paket für das auch eine spätere Deinstallation möglich ist. dpkg -i \u0026lt;paketname\u0026gt; ## installiert das Paket source aus tmp wieder löschen!  ###Nicht mehr unterstützte Pakete (LTS) anzeigen\nubuntu-support-status \u0026ndash;show-unsupported\nStartup / Initscripte #  Damit ein Service beim hochfahren gestartet wird kann man unter Debian/Ubuntu update-rc.d nutzen. Die Init Scripte liegen unter /etc/init.d über rc1-x werden die Initscripte per symlink verlinkt. Das K(ill) oder S(tart) vor den Scriptnamen und die Zahl legen die Reihenfolge und das hoch- oder runterfahren fest.\n# update-rc.d SERVICE-NAME defaults  Um den Service wieder zu entfernen.\n# update-rc.d SERVICE-NAME remove  Benutzer anlegen/löschen/verwalten #  useradd -m USERNAME -g sudo -s /bin/bash #mit Homeverzeichnis und gleich in die Gruppe sudo groups USERNAME #grp eines users anzeigen adduser USERNAME GROUP#user in grp adden addgroup GROUP #neu Gruppe usermod -a username -G sudo # user der gruppe Sudu hinzufügen (visible after next login) userdel -r username # User mit seinem Homeverzeichnis löschen usermod -d /path/to/new/home -m username #ändert das Homeverzeichnis und kopiert ggfs die Daten aus dem alten  ###Dateien verschieben\nscp file to host scp SourceFile user@host:directory/TargetFile\nscp folder FROM host scp -r user@host:directory/SourceFolder TargetFolder\n#netstat\noffen port mit zugehöriger application netstat -lnptu routen anzeigen netstat -r\n###packen tar cvf backup.tar directory bzip2 -9 backup.tar ###auspacken bunzip backup.tar.bz2 tar xfv backup.tar\nMöglichkeiten die Linuxdistro rausfinden #  cat /etc/*release cat /etc/*version cat /etc/issue cat /proc/version getconf LONG_BIT #64 oder 32 bit  ###cert request\nopenssl req -nodes -newkey rsa:4096 -keyout domainname.key -out domainname.csr  das Keyfile anschließend sofort mit chmod 600 domainname.key schützen und den Inhalt des csr unter https://caserver/certsrv in eine cer umwandeln\nRequest mit alternate names erzeugt man, indem man ein conf file erstellt. Das sollte so aussehen.\n[req] distinguished_name = req_distinguished_name req_extensions = v3_req\n[req_distinguished_name] countryName = Country Name (2 letter code) countryName_default = DE stateOrProvinceName = State or Province Name (full name) stateOrProvinceName_default = Hamburg localityName = Locality Name (eg, city) localityName_default = Hamburg organizationalUnitName = Organizational Unit Name (eg, section) organizationalUnitName_default = IT commonName = commonName (Hostname, etc.) commonName_max = 64 emailAddress = E-Mailaddress emailAddress_default = yourmailadresse@mail.com emailAddress_max = 40\n[v3_req] keyUsage = keyEncipherment, dataEncipherment extendedKeyUsage = serverAuth subjectAltName = @alt_names\n[alt_names] DNS.1 = foobar.com DNS.2 = foobar DNS.3 = secondname.foobar.com IP.1 = 192.168.1.100 IP.2 = 192.168.1.200\nUnter alt_names kann man weitere Namen und IP Adressen hinzufügen. Die Werte unter [req_distinguished_name] müssen nicht unbedingt angepasst werden, da sie beim csr erstellen nochmal abgefragt werden. Dann muss der csr mit dem Configfile erstellt werden:\nopenssl req -nodes -newkey rsa:4096 -keyout domainname.key -out domainname.csr -config configfile  Zertifikate konvertieren #  Convert a DER file (.crt .cer .der) to PEM\nopenssl x509 -inform der -in certificate.cer -out certificate.pem  Convert a PEM file to DER\nopenssl x509 -outform der -in certificate.pem -out certificate.der  Convert a PKCS#12 file (.pfx .p12) containing a private key and certificates to PEM\nopenssl pkcs12 -in keyStore.pfx -out keyStore.pem -nodes  You can add -nocerts to only output the private key or add -nokeys to only output the certificates.\nConvert a PEM certificate file and a private key to PKCS#12 (.pfx .p12)\nopenssl pkcs12 -export -out certificate.pfx -inkey privateKey.key -in certificate.crt -certfile CACert.crt  Zertifikate auslesen #  openssl x509 -in yourcert.pem -inform pem -noout -text\nVerify if key belongs to certificate #  openssl x509 -noout -modulus -in wildcard.domain.net.crt | openssl md5 1f6485eac12a42c17a778f82105b268e\nopenssl rsa -noout -modulus -in wildcard.domain.net.key | openssl md5 1f6485eac12a42c17a778f82105b268e\nverify chain with openssl #  openssl verify -CAfile RootCert.pem -untrusted Intermediate.pem UserCert.pem\nopenssl encrytion #  encrypt\n$ openssl enc -aes-256-cbc -salt -pbkdf2 -iter 100000 -in file.txt -out file.txt.enc\ndecrypt\n$ openssl enc -aes-256-cbc -d -in file.txt.enc -out file.txt\n###Ordnergröße sortiert anzeigen im aktuellen Dir du -hs * | sort -r\nOrdnergröße aller Unterordner summieren und anzeigen\ndu -cksh * |sort -g  Alle großen Dateien über 20MB finden und anzeigen\nfind / -type f -size +20000k -exec ls -lh {} \\; | awk '{ print $9 \u0026quot;: \u0026quot; $5 }'  ###symlink ln -s quelle ziel\nTCP traffic Analyse #  traffic from 10.5.2.3 destined for port 3389 tcpdump -nnvvS and src 10.5.2.3 and dst port 80 and dst 172.20.1.8 -w caputurefile\nsudo tcpdump -nnvvS src 172.20.0.24 -w caputurefile sudo tcpdump -nnvvS port 5353 sudo tcpdump -nnvvS -n arp  -s 0 #für vollständige packete anhängen.\nmysql service neu starten #  falls service mysql restart nicht reicht, um den Prozess neu zu starten ist vielleicht upstart das Problem. Dann hilft\ninitctl \u0026ndash;system stop mysql initctl \u0026ndash;system start mysql\n###mysql User anlegen\nmysql -u root -p #einloggen mit dem root user  alle User anzeigen\nselect host, user, password from mysql.user;  neuen User anlegen\nCREATE USER 'username'@'localhost' IDENTIFIED BY 'some_pass';  Berechtigungen für den User der auf alle Datenbanken zugreifen kann:\nGRANT ALL PRIVILEGES ON *.* TO 'username'@'localhost' IDENTIFIED BY 'some_pass';  neuen User anlegen der auf eine bestimmte Datenbank zugreifen kann:\nGRANT ALL PRIVILEGES ON dbname.* TO 'username'@'localhost' IDENTIFIED BY 'some_pass';  ALL PRIVILEGES- as we saw previously, this would allow a MySQL user all access to a designated database (or if no database is selected, across the system) CREATE- allows them to create new tables or databases DROP- allows them to them to delete tables or databases DELETE- allows them to delete rows from tables INSERT- allows them to insert rows into tables SELECT- allows them to use the Select command to read through databases UPDATE- allow them to update table rows GRANT OPTION- allows them to grant or remove other users privileges\nYou can grant multiple privileges in one command by separating them with commas: eg:\nGRANT UPDATE, SELECT ON [database name].[table name] TO ‘[username]’@‘localhost’;  Berechtigungen wieder entziehen\nREVOKE [type of permission] ON [database name].[table name] FROM ‘[username]’@‘localhost’;  reload all permissions\nFLUSH PRIVILEGES;  delete a user\nDROP USER ‘demo’@‘localhost’;  Show all Databases\nshow databases;  kaputte mysql Tabelle reparieren\nmysql -uroot -p use databasename; check table tablename; repair table tablename;  Datenbank exportieren\n$ mysqldump --lock-tables database -u USER -p [tables] \u0026gt; database.sql  Datenbank importieren\n$ mysql -p dbname -u USER -p \u0026lt; dumpfile.sql  Datenbank auf anderen host importieren $ mysql -P 3310 -h 10.0.0.100 -p dbname -u USER -p \u0026lt; dumpfile.sql\nDatenbank in Container importieren\n$ docker exec -i \u0026lt;Container_ID or Container_Name mysql -u[mysql_user] -p[mysql_user_password] [database] \u0026lt; [database_backup_file.sql]  Ausgabe umleiten 2\u0026gt;\u0026amp;1 (hinter Snagview Checkcommands sehr praktisch)\n###iptables\n#show all Rules with port numbers (exept NAT Rules)\niptables -L -n  #removes a rule at in a specific chain with a certain line number\niptables -D INPUT \u0026lt;linenumber\u0026gt;  #accept new mysql connections from a specific ip and insert the rule in third place\niptables -I INPUT 3 -p tcp -i eth0 -s 172.20.4.17 --dport 3306 -m state --state NEW -j ACCEPT  Allows HTTP and HTTPS connections from anywhere (the normal ports for websites) #  iptables -A INPUT -p tcp --dport 80 -j ACCEPT  Drops a Traffic to port 80 for a specific source ip #  iptables -A INPUT -p tcp -s \u0026lt;sourceip\u0026gt; --dport 80 -j DROP  removes this rule #  iptables -D INPUT -p tcp -s \u0026lt;sourceip\u0026gt; --dport 80 -j DROP  iptables speichern:\nsudo sh -c \u0026quot;iptables-save \u0026gt; /etc/iptables.rules\u0026quot;  iptables laden:\niptables-restore -c \u0026lt; /etc/iptables.rules Basic Rules: (iptables.rules) Generated by iptables-save v1.4.12 on Sun Nov 18 21:17:25 2012 *filter :INPUT ACCEPT [0:0] :FORWARD ACCEPT [0:0] :OUTPUT ACCEPT [0:0] -A INPUT -p tcp -m tcp --dport 80 -j ACCEPT -A INPUT -p tcp -m tcp --dport 443 -j ACCEPT -A INPUT -p tcp -m tcp --dport 22 -j ACCEPT -A INPUT -p icmp -j ACCEPT -A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT -A INPUT -j DROP -A FORWARD -j DROP -A OUTPUT -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT -A OUTPUT -j DROP COMMIT # Completed on Sun Nov 18 21:17:25 2012  to apply iptables on startup: insert this into /etc/network/interfaces\npre-up iptables-restore \u0026lt; /etc/iptables.rules  script zum iptables sichern\n#!/bin/sh sudo sh -c \u0026quot;iptables-save \u0026gt; /etc/iptables.rules\u0026quot; STATE=0 if [ $? -eq 0 ] ;then echo \u0026quot;IPTABLES saved\u0026quot; STATE=1 else echo \u0026quot;something went wrong\u0026quot; fi exit $STATE  netools vs. iproute2 commands #  arp -na ip neigh ifconfig ip link ifconfig -a ip addr show ifconfig -s ip -s link ifconfig eth0 up ip link set eth0 up ipmaddr\tip maddr iptunnel\tip tunnel\nnetstat\tss netstat -i ip -s link netstat -g ip maddr netstat -l ss -l netstat -r ip route\nroute add ip route add route del ip route del route -n ip route show\nset the ip for eth0 to 172.16.1.1/24\nifconfig eth0 172.16.1.1/24 up ip addr add 172.16.1.1/24 dev eth0  set new default route\nroute add default gw 192.168.1.254 eth0 ip route add default dev eth0 via 192.168.1.254  add/delete static route\nroute add -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.254 route del -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.254 ip route add 172.16.29/24 dev eth0 ip route del 172.16.29/24 dev eth0  auf Routern muss das IP Forwarding aktiviert werden\nsudo sysctl -w net.ipv4.ip_forward=1  key #  erzeugen\nssh-keygen -t rsa -b 8192 -f mykeyfile_rsa  ssh key ohne ssh-copy-id deployen\ncat ~/.ssh/id_rsa.pub | ssh username@host \u0026quot;cat – \u0026gt;\u0026gt; ~/.ssh/authorized_keys\u0026quot;  alternativ mit ssh-copy-id\nssh-copy-id -i ~/.ssh/id_rsa.pub remote-host  Shell Magic #  exitcode des letzten Befehls\necho $?  CPAN #  *aufrufen mit:\nperl -MCPAN -e 'shell'  *Module suchen\ni /Net::SNMP/  *suchen nach dem richtigen Modulnamen und installieren\ninstall Net::SNMP  package managment #  show installed packages dpkg -l\nrsyslog #  to prevent rsyslog from spamming the syslog change /etc/rsyslog.d/50-default.conf\n*.*;auth,authpriv.none,cron.none,mail.none -/var/log/syslog cron.*\t/var/log/cron.log mail.* -/var/log/mail.log  for syslog-ng uncomment this in /etc/syslog-ng/syslog-ng.conf\ndestination cron { file(\u0026quot;/var/log/cron\u0026quot;); }; log { source(src); filter(f_cron); destination(cron); };  and change this line (add cron)\nfilter f_messages { not facility(news, mail,cron) and not filter(f_iptables); };  Don\u0026rsquo;t forget logrotate (/etc/logrotate.d/syslog) or things get ugly\nto forward syslog messages to another syslog-ng insert this into the /etc/syslog-ng/syslog-ng.conf\ndestination d_udp514 {udp(\u0026ldquo;loghost\u0026rdquo; port (514));}; log { source(src); filter(f_messages); destination(messages); destination(d_udp514);};\nfor rsyslogd and syslogd add this in /etc/rsyslog.d/50-default.conf or /etc/syslog.conf\n. @loggingserverip_or_hostname:514\nDNS Server mit resolfconf ändern ohne Interfaceneustart #  echo \u0026quot;nameserver 8.8.8.8 search example.com\u0026quot; | sudo resolvconf -a eth0.inet  Damit das dauerhaft greift, muss der DNS Server in /etc/network/interfaces eingetragen sein.\ndns-search example.com dns-search-nameservers 8.8.8.8  LVM mounten #  Install lvm2: $ sudo apt-get install lvm2 Load the necessary module(s): $ sudo modprobe dm-mod Scan your system for LVM volumes and identify in the output the volume group name that has your Fedora volume (mine proved to be VolGroup00): $ sudo vgscan Activate the volume: $ sudo vgchange -ay VolGroup00 Find the logical volume that has your Fedora root filesystem (mine proved to be LogVol00): $ sudo lvs Create a mount point for that volume: $ sudo mkdir /mnt/fcroot Mount it: $ sudo mount /dev/VolGroup00/LogVol00 /mnt/fcroot -o ro,user\n###mit chroot auf andere Platten zugreifen\nSysten z.B. unter /mount/point einbinden\n# mount -o bind /proc /mount/point/proc # mount -o bind /dev /mount/point/dev # mount -o bind /dev/pts /mount/point/dev/pts # mount -o bind /sys /mount/point/sys  für DNS Auflösung\n# cp /etc/resolv.conf /mount/point/etc/resolv.conf  Shell aufmachen\n# chroot /mount/point /bin/bash  rename an ubuntu after cloning the vm #  change configs in /etc/hostname /etc/hosts /etc/network/interfaces restart the interfaces /etc/init.d/networking restart\ninsert new harddrive to vm with LVM #  check the lvm and the existing hdds first\npvdisplay fdisk -l  Add the hdd via the vpshere console. The new disk will show up something like this\n\u0026quot;Disk /dev/sdb doesn't contain a valid partition table\u0026quot;  Time to format the new disk and create an LVM Partition. We assume that /dev/sdb is the new drive\nfdisk /dev/sdb n p 1 2x Enter to use the complete disk t 8e (to change the partion to LVM)\nverify the change with \u0026ldquo;p\u0026rdquo; Device Boot Start End Blocks Id System /dev/sdb1 2048 88080383 44039168 8e Linux LVM\nWrite the new partition table with \u0026ldquo;w\u0026rdquo; Now create a new LVM physical volume\npvcreate /dev/sdb1  Now we add the Harddrive to our existing VG (Volume Group)\nvgextend u1404template-vg /dev/sdb1  Next we extent the size of the Logical Volume, by the size of the new HDD (42 GB in this example)\nlvextend -L+42GB /dev/mapper/u1404template\u0026ndash;vg-root\nThe last step is to resize the filesysem with\nresize2fs /dev/mapper/u1404template\u0026ndash;vg-root\nNow you should see that the main LV is larger\ninsert new harddrive in a virtual server #  check the drives\n sudo cat /proc/scsi/scsi  to rescan the drives install\napt-get install scsitools  rescan\nrescan-scsi-bus.sh  recheck the drives\n sudo cat /proc/scsi/scsi  list all hdds\nfdisk -l  oder\nfdisk -l /dev/sdb  Disk /dev/sdb: 1073 MB, 1073741824 bytes 255 heads, 63 sectors/track, 130 cylinders Units = cylinders of 16065 * 512 = 8225280 bytes\nDisk /dev/sdb doesn\u0026rsquo;t contain a valid partition table\npartion mit fdisk anlegen\nalle Partitionen auf sdb anzeigen fdisk /dev/sdb dann p\nneue Partition anlegen\nI start fdisk from the shell prompt: fdisk /dev/hdb which indicates that I am using the second drive on my IDE controller. (See Section 2.1.) When I print the (empty) partition table, I just get configuration information.\nCommand (m for help): p Disk /dev/hdb: 64 heads, 63 sectors, 621 cylinders Units = cylinders of 4032 * 512 bytes I knew that I had a 1.2Gb drive, but now I really know: 64 * 63 * 512 * 621 = 1281982464 bytes. I decide to reserve 128Mb of that space for swap, leaving 1153982464. If I use one of my primary partitions for swap, that means I have three left for ext2 partitions. Divided equally, that makes for 384Mb per partition. Now I get to work. Command (m for help): n Command action e extended p primary partition (1-4) p Partition number (1-4): 1 First cylinder (1-621, default 1):\u0026lt;RETURN\u0026gt; Using default value 1 Last cylinder or +size or +sizeM or +sizeK (1-621, default 621): +384M  Next, I set up the partition I want to use for swap:\nCommand (m for help): n Command action e extended p primary partition (1-4) p Partition number (1-4): 2 First cylinder (197-621, default 197):\u0026lt;RETURN\u0026gt; Using default value 197 Last cylinder or +size or +sizeM or +sizeK (197-621, default 621): +128M Now the partition table looks like this: Device Boot Start End Blocks Id System /dev/hdb1 1 196 395104 83 Linux /dev/hdb2 197 262 133056 83 Linux  I set up the remaining two partitions the same way I did the first. Finally, I make the first partition bootable: Command (m for help): a Partition number (1-4): 1 And I make the second partition of type swap: Command (m for help): t Partition number (1-4): 2 Hex code (type L to list codes): 82 Changed system type of partition 2 to 82 (Linux swap) Command (m for help): p The end result: Disk /dev/hdb: 64 heads, 63 sectors, 621 cylinders Units = cylinders of 4032 * 512 bytes\n Device Boot Start End Blocks Id System /dev/hdb1 * 1 196 395104+ 83 Linux /dev/hdb2 197 262 133056 82 Linux swap /dev/hdb3 263 458 395136 83 Linux /dev/hdb4 459 621 328608 83 Linux  Finally, I issue the write command (w) to write the table on the disk.\nPlatten formatieren z.b. mit\nmkfs.ext3 /dev/sdb1  Eintrag in /etc/fstab machen\n/dev/sdb1 /mountpoint ext3 defaults 0 2  programm ohne sudo mit setuid bit ausführen #  Owner muss root sein chown root:wheel program\nsetuid bit setzen chmod u+s program\nsmbshares mounten #  sudo apt-get install cifs-utils  On older systems:\nsudo apt-get install smbfs  First, let\u0026rsquo;s create the mount directory. You will need a separate directory for each mount.\nsudo mkdir /media/windowsshare Then edit your /etc/fstab file (with root privileges) to add this line:\n//servername/sharename /media/windowsshare cifs guest,uid=1000,iocharset=utf8 0 0 Where\nguest indicates you don\u0026rsquo;t need a password to access the share, uid=1000 makes the Linux user specified by the id the owner of the mounted share, allowing them to rename files, iocharset=utf8 allows access to files with names in non-English languages. This doesn\u0026rsquo;t work with shares of devices like the Buffalo Tera Station, or Windows machines that export their shares using ISO8895-15. After you add the entry to /etc/fstab type:\nsudo mount -a This will (re)mount all entries listed in /etc/fstab.\nThe quickest way to auto-mounting a password-protected share is to edit /etc/fstab (with root privileges), to add this line:\n//servername/sharename /media/windowsshare cifs username=msusername,password=mspassword,iocharset=utf8,sec=ntlm 0 0 This is not a good idea however: /etc/fstab is readable by everyone and so is your Windows password in it. The way around this is to use a credentials file. This is a file that contains just the username and password.\nUsing a text editor, create a file for your remote servers logon credential:\ngedit ~/.smbcredentials Enter your Windows username and password in the file:\nusername=msusername password=mspassword Save the file, exit the editor.\nChange the permissions of the file to prevent unwanted access to your credentials:\nchmod 600 ~/.smbcredentials Then edit your /etc/fstab file (with root privileges) to add this line (replacing the insecure line in the example above, if you added it):\n//servername/sharename /media/windowsshare cifs credentials=/home/ubuntuusername/.smbcredentials,iocharset=utf8,sec=ntlm 0 0 Save the file, exit the editor.\nFinally, test the fstab entry by issuing:\nsudo mount -a If there are no errors, you should test how it works after a reboot. Your remote share should mount automatically.\nnfs shares #  nfs share mounten #  sudo mount -t nfs host:/share /mountpoint  nfs share über fstab mounten #  host:/share /mountpoint nfs rsize=8192,wsize=8192,timeo=14,intr  Berechtigungen #  Permission rwx #  7 read, write and execute 111 6 read and write 110 5 read and execute 101 4 read only 100 3 write and execute 011 2 write only 010 1 execute only 001 0 none 000\n$ chmod u=rw,g=rx,o= internalPlan.txt\n/home 700 ./ssh 700 authorised_key 600 startupscripte in /etc/init.d/ 755\nFilepermissions oktal anzeigen\nstat -c \u0026quot;%a %A %n\u0026quot; /usr/bin/*  umask gilt für einen Prozess und verhindert Filepermissions beim Anlagen. #  $ umask # display current value 0022 $ umask 0077 #set to prevent files from being created with any access by group members or others $ umask #display confirms new setting 0077 $ umask -S # display symbolically u=rwx,g=,o=\nOctal in umask Prevents (if requested) 7 read, write and execute 6 read and write 5 read and execute 4 read only 3 write and execute 2 write only 1 execute only 0 no permissions\numask u-x,g=r,o+w\nuser hat kein execute mehr group darf nur lesen alle dürfen zusätzlich schreiben\numask a+r alle dürfen lesen\n###installing likewise-open\napt-get install likewise-open domainjoin-cli join domainname.local domainadmin lwconfig homedirtemplate %H/%U lwconfig AssumeDefaultDomain true lwconfig RequireMembershipOf domain\\\\group^name lwconfig CacheEntryExpiry 30  Add the following line to /etc/sudoers:\n%group^name ALL=(ALL) ALL  aliase #  alias ls='ls -lahn'  User ausloggen #  Damit werden alle Prozesse des Users administator beendet und er wird damit natürlich auch ausgelogt pkill -KILL -u administrator\nUser sperren #  Damit ein User sich nicht mehr einloggen kann sperrt man ihn mit passwd\npasswd -l username  Netzwerk #  Netzwerkkarten konfigurieren #  in /etc/network/interfaces für DCHP\nauto eth0 iface eth0 inet dhcp  für statische IP\niface eth0 inet static address 192.168.1.2 netmask 255.255.255.0 gateway 192.168.1.1 dns-search domain.local dns-nameservers 8.8.8.8 8.8.8.8  videodownload script #  #!/bin/zsh STATE=0 target=/var/www/sandmann newfilename=sandmann-date +%d-%m-%Y.wmv logger starte mplayer capture mplayer -dumpstream -dumpfile $target/$newfilename mmsh://85.239.122.162/mk3w-3faw-3rqf-enc0-kika?MSWMExt=.asf \u0026amp; sleep 722 killall mplayer exit $STATE\nSQLITE3 Commands #  Open a database\nsqlite3 tablename  Show Tables in this database\n.tables  Show a specific tableschema\n.schema tablename  Show the content of a table\nSELECT * FROM table;  Shows the help\n.help  autocomplete für services #  alle Dienste aus /etc/init.d/ autocompleten (am besten in die .bashrc)\ncomplete -W \u0026quot;$(ls /etc/init.d/)\u0026quot; service  Glance installieren (https://github.com/nicolargo/glances) #  pip installieren #  wget https://bitbucket.org/pypa/setuptools/raw/bootstrap/ez_setup.py sudo python ez_setup.py wget https://raw.github.com/pypa/pip/master/contrib/get-pip.py sudo python get-pip.py\npython-dev installieren für psutil (Abhängigkeit wird von Glance aufgelöst) #  sudo apt-get install python-dev sudo pip install Glances\nsudo pip install psutil (falls psutil doch nicht installiert wurde)\nspezielle Version eines Pakets installieren #  sudo pip install ansible==2.0.0.2\nuse \u0026ndash;user python on OSX 10.11 to bypass a rootless problem while upgrading #  pip install \u0026ndash;upgrade setuptools \u0026ndash;user python\nScript das beim Start jeder SSH Session ausgeführt wird #  /etc/ssh/sshrc\nnützlich z. B. für login\nhttp zu https forwarden mit Apache2 #  zuerst: a2enmod rewrite ggfs noch: a2enmod ssl\n RewriteEngine On RewriteCond %{SERVER_PORT} !^443$ RewriteRule (.*) https://%{HTTP_HOST}$1 [R=301,L]  Seite mit htaccess schützen #  Entweder in die Directory Directive im vhost.conf oder in eine .htaccess im jeweiligen Ordner\nAuthName \u0026quot;Sitename or Banner\u0026quot; AuthType Basic AuthUserFile \u0026quot;/path/to/.htpasswd\u0026quot; require valid-user  apt install apache2-utils #  #neues htpasswd file htpasswd -c /home/pwww/.htpasswd jerry\n#password für den User jerry ändern htpasswd /home/pwww/.htpasswd-users jerry\ntshark #  apt install tshark\nsudo usermod -a -G wireshark logout/login again\nFilter for TLS versions\ntshark -T fields -e ssl.record.version  0x0300 SSL 3.0 0x0301 TLS 1.0 0x0302 TLS 1.1 0x0303 TLS 1.2\nFilter DNS Querys\ntshark -f \u0026quot;src port 53\u0026quot;  "},{"id":10,"href":"/docs/lxc/","title":"LXC Cheatsheet","section":"Cheatsheets","content":"LXC Config Cheatsheet #  first lxd config\nlxd init  check the zpool\nzpool list zpool status check zfs\nzfs list  show lxd config\nlxc profile show default  Public images\nlxc image list images:  Install and run an image\nlxc launch images:alpine/3.8/i386 alpine-test  Finding containers\n$ lxc list --fast $ lxc list | grep RUNNING $ lxc list | grep STOPPED runnnig commands in containers\nlxc exec containerName -- command lxc exec containerName -- /path/to/script lxc exec containerName --env EDITOR=/usr/bin/vim -- command enter a shell in a container\nlxc exec debian9-c4 bash  start/stop/restart/delete a container\nlxc [start|stop|restart|delete] containerName  show infos about a container\nlxc info containerName  add a br0 to neplan config\nbridges: br0: interfaces: [enp0s31f6] dhcp4: true dhcp6: true Change the default lxc bridge\nlxc profile edit default. config: {} description: Default LXD profile devices: eth0: name: eth0 nictype: bridged parent: br0 #change this to br0 type: nic name: default show the config for a container #   lxc config show containerName  Autostarting containers on boot #  lxc config set pihole boot.autostart true lxc config get pihole boot.autostart you can also define the priority if you\u0026rsquo;re starting more than one container and the delay\n$ lxc config set {vm-name} boot.autostart.priority integer $ lxc config set {vm-name} boot.autostart.delay integer share folder from the host to the container #  https://ubuntu.com/blog/mounting-your-home-directory-in-lxd\nExample\necho 'root:1000:1' | sudo tee -a /etc/subuid /etc/subgid lxc config set containerName raw.idmap 'uid 1000 105' lxc config set containerName raw.idmap 'gid 0 0' lxc config device add containerName homedir disk source=/home/tycho path=/home/ubuntu only the user that owns the folder inside the container, can write to it. Even root is not allowed!\n"},{"id":11,"href":"/docs/macos/","title":"MacOS Cheatsheet","section":"Cheatsheets","content":"Bonjourbrowser #  $ dns-sd -B _afpovertcp._tcp Browsing for _afpovertcp._tcp DATE: ---Thu 16 Jun 2016--- 9:44:33.789 ...STARTING... Timestamp A/R Flags if Domain Service Type Instance Name 9:44:33.790 Add 2 9 local. _afpovertcp._tcp. netsus-server speed up cifs/smb #  \tsudo sysctl -w net.inet.tcp.delayed_ack=0 persist it in /etc/sysctl.conf\nLaunchd #  alle Einträge anzeigen\n\tlaunchctl list netzwerkverkehr sniffen #  alles auf der Netzwerkkarte\n\tsudo tcpdump -n -i en0 DNS Cache löschen #  Mac OS X Lion, Mountain Lion (10.7, 10.8)\n\tsudo killall -HUP mDNSResponder Mac OS X Leopard, Snow Leopard (10.5, 10.6)\n\tsudo dscacheutil -flushcache versteckte Dateien im Finder an/aus #  \tdefaults write com.apple.Finder AppleShowAllFiles YES Mobile Backups on Macbook Pro #  On a MPB with Lion or Mountain Lion the mobile Backups under /Volumes/MobileBackups can consume a lot of space. You can confirm this by looking into the Storage tab via about my mac. This backup is matched against a time maschine backup, but there is no switch in the sys prefs to disable it. But you can via terminal. Reboot afterwards and the mobile backups are gone.  \tsudo tmutil disablelocal mySQL starten #  \tsudo /usr/local/mysql/bin/mysqld_safe Alternative\n\t/usr/local/bin/mysql.server start MongoDB starten #  To have launchd start mongodb at login:\n\tln -sfv /usr/local/opt/mongodb/*.plist ~/Library/LaunchAgents Then to load mongodb now:\n launchctl load ~/Library/LaunchAgents/homebrew.mxcl.mongodb.plist Or, if you don\u0026rsquo;t want/need launchctl, you can just run:\n mongod --config /usr/local/etc/mongod.conf Netboot #  C : Forces most Macs to boot from the CD-Rom drive instead of the internal hard drive. Only works with Apple ROM drives and with bootable CD discs. D : Forces the first internal hard drive to be the startup disk. N : Netboot (New World ROM machines only) – Looks for BOOTP or TFTP Server on the network to boot from R : Forces PowerBooks to reset their screen to default size (helpful if you’ve been hooked up to an external montior or projector!) T : Target Disk Mode (FireWire) – Puts machines with built-in FireWire into target Disk mode so a system attached with a FireWire cable will have that device show up as a hard drive on their system. Very useful for PowerBooks! Mouse Button Held Down : Ejects any mounted removable media. Shift : Disables all extensions (Mac OS 7-9), or disables Login items when using Mac OS X 10.1.3 or later. Also works when booting Classic mode up just like you were using the OS natively. Option : When using an Open Firmware \u0026quot;New World ROM\u0026quot; capable system, the System Picker will appear and query all mounted devices for bootable systems, returning a list of drives \u0026amp; what OS they have on them. On \u0026quot;Old World\u0026quot; systems the machine will simply boot into it’s default OS without any Finder windows open. Space bar : Brings up Apple’s Extension Manager (or Casady \u0026amp; Greene’s Conflict Catcher, if installed) up at startup to allow you to modify your extension set. Command-V : Boots Mac OS X into \u0026quot;Verbose Mode\u0026quot;, reporting every console message generated during startup. Really shows what’s going on behind the scenes with your machine on startup! Command-S : Boots Mac OS X into \u0026quot;Single User Mode\u0026quot; – helpful to fix problems with Mac OS X, if necessary. Command-Option : Rebuilds the Desktop (Mac OS 7-9). Command-Option-P-R : Erases PRAM if held down immediately after startup tone. Your machine will chime when it’s erased the PRAM, most people will hold this combination for a total of 3 chimes to really flush the PRAM out. Command-Option-N-V : Erases NVRAM (Non-Volatile RAM). Used with later Power Macintosh systems mostly. Command-Option-O-F : Boots the machine into Open Firmware (New World ROM systems only). Command-Option-Shift-Delete : Forces your Mac to startup from its internal CD-ROM drive or an external hard drive. Very helpful if you have a 3rd party CD-ROM drive that is not an Apple ROM device. Command-Option-Shift-Delete-#(where #= a SCSI DEVICE ID) : Boot from a specific SCSI device, if you have your 3rd party CD-ROM drive set to SCSI ID 3, you would press \u0026quot;3\u0026quot; as the # in the combination.  "},{"id":12,"href":"/docs/mongodb/","title":"MongoDB Cheatsheet","section":"Cheatsheets","content":"MongoDB Cheatsheet #  You can find a full list of all Command in the Manual\nopen the mongoshell\nmongo  show all database and their size\nshow dbs;  switch to a database\nuse permissions_production;  show all collections\nshow collections;  show all datasets in a collection and format the human readable\ndb.rentals.find().pretty()  count all datasets, without showing them\ndb.rentals.find().count()  Search for a specific value\ndb.users.find({\u0026quot;name\u0026quot;: /.*m.*/})  or\ndb.users.find({\u0026quot;name\u0026quot;: /m/})  to delete events\ndb.eventlog_events.remove({al:false, bl:false}); "},{"id":13,"href":"/docs/python/","title":"Python Cheatsheet","section":"Cheatsheets","content":"Python cheatsheet #  shebang for pythonscripts #  #!/usr/bin/env python\nvariable type #  strings #  concatinate strings like a pro\nfoobar = ''.join(['foo', 'bar'])  dictionary #  test = {'name':'John','job':'teacher'} print test['job'] # prints teacher print test.key() #prints ['name','job'] print test.values() #prints ['John','teacher'] print test.items() #prints [('name','teacher'),('nextkey','nextvalue')] for key in test: print key,test[key] #prints name John \\n job teacher  lists #  zoo_animals = [\u0026quot;pangolin\u0026quot;, \u0026quot;cassowary\u0026quot;, \u0026quot;sloth\u0026quot;] zoo_animals.append(\u0026quot;ape\u0026quot;) first = zoo_animals[0:2] # The first two items;second parm ends -before- index b zoo_animals.insert(1,\u0026quot;cobra\u0026quot;) #change cassowary to cobra zoo_animals.index(\u0026quot;cobra\u0026quot;) # returns 1  list comprehension #  evens_to_50 = [i for i in range(51) if i % 2 == 0] print evens_to_50 #prints [0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50] new_list = [x for x in range(1,6)] #prints [1, 2, 3, 4, 5] new_list = [x*2 for x in range(1,6)] #prints [2, 4, 6, 8, 10] look for items in my_list and put them into my_other_list if they are not already there my_list=[2,2,3,40] my_other_list =[] for i in my_list: if i not in my_other_list: no_dups.append(i)  list slicing #  l = [i ** 2 for i in range(1, 11)] # Should be [1, 4, 9, 16, 25, 36, 49, 64, 81, 100 print l[2:9:2] #[start:end:stride] stride describes the space between items in the sliced list. # [9, 25, 49, 81] print l[::5] # [1,25,100] # every 5th  return vars greater then 4\na = [3, 4, 5] b = [i for i in a if i \u0026gt; 4] or b = filter(lambda x: x \u0026gt; 4, a)  enumerate a list\na = [3, 4, 5] a = [i + 3 for i in a]  Or: a = map(lambda i: i + 3, a)\nfor index, item in enumerate(list): print index, item  functions #  using functions the right way #  def make_complex(x, y): return {\u0026lsquo;x\u0026rsquo;: x, \u0026lsquo;y\u0026rsquo;: y} # return a list instead of just a var\nfor schleife 5x durchlaufen\nfor i in range(5):  Userinpt\nx = raw_input(\u0026quot;prompt\u0026quot;)  print without a newline\nprint something,  files #  open files the right way\nwith open('file.txt') as f: for line in f: print line with open(\u0026quot;text.txt\u0026quot;, \u0026quot;w\u0026quot;) as textfile: textfile.write(\u0026quot;Success!\u0026quot;)  binary #  print 0b111 #7 print 0b1 + 0b11 #4 print int(\u0026ldquo;11001001\u0026rdquo;,2) #201 because int(string,base) print bin(2) #0b10 print ~2 # prints -3 because 1 is added and then the numbers turns negative\ncheck if bit is set:\nmask = 0b100 #check if the 3rd bit is on a=0b110 desired = a \u0026amp; mask #if desired is greater than 0 == true\nturning bits on:\na = 0b110 # 6 mask = 0b1 # 1 desired = a | mask # 0b111, or 7\nbitflipping:\na = 0b110 # 6 mask = 0b111 # 7 (always fill all needed bits with 1) desired = a ^ mask # 0b1\n"},{"id":14,"href":"/docs/ruby-setup/","title":"Ruby Setup on a Macbook","section":"Cheatsheets","content":"Ruby Setup #  First install rbenv and ruby-build to have different ruby versions. Could have used rvm, but it looks a little bit like rotten foot.\n$ brew update $ brew install rbenv ruby-build $ echo \u0026#39;eval \u0026#34;$(rbenv init -)\u0026#34;\u0026#39; \u0026gt;\u0026gt; ~/.zshrc list all available versions: #  $ rbenv install -l  install a Ruby version: #  $ rbenv install 2.0.0-p247  switch to a specific ruby version only for the current session #  $ rbenv local 1.9.3-p327  switch to a ruby version in all shell #  $ rbenv global 1.9.3-p327  Command Reference here: https://github.com/sstephenson/rbenv\n$ gem update $ gem install rails to locate a gem #  $ gem which gemname  show the local gem version #  $ gem list -l gemname  uninstall a gem #  $ gem uninstall gemname  to show some infos about the current gem enviroment, including the gem directories #  $ gem environment  print the ruby on rails version for the project in the current directory #  or it prints the default ruby on rails version #  $ rails --version \u0026gt; \u0026#34;Rails 4.1.0\u0026#34; update rails with #  $ gem install rails \u0026gt; \u0026quot;Rails 4.1.4\u0026quot; install specific rails version #  $ gem install rails --version 3.1.0  run a command with a specific rails version (won\u0026rsquo;t affect already created rails projects) #  $ rails _3.1.0_ --version  to update/downgrade ruby on rails change the rails version in the gem file and run #  $ bundle update $ bundle install to update/downgrade only a specific section (eg. and ignore production) #  $ bundle install --without production  bundler and mojave #  To install older nokogiri gems (1.8.5) add this to ./bundle/config within the project folder or in your dotfiles\nBUNDLE_BUILD__NOKOGIRI: \u0026quot;--use-system-libraries=true --with-xml2-include=/usr/local/opt/libxml2/include/libxml2\u0026quot; BUNDLE_JOBS: \u0026quot;7\u0026quot; BUNDLE_PATH: \u0026quot;vendor/bundle\u0026quot;  To install mysql2 gem on mojave\nsudo installer -pkg /Library/Developer/CommandLineTools/Packages/macOS_SDK_headers_for_macOS_10.14.pkg -target /  "}]